#############################
# YASS configuration schema #
#############################

# Definition reference: http://docs.python-cerberus.org/en/stable/

data:
  type: dict
  required: True
  schema:
    # project's root folder, data will be loaded and saved here
    # can be an absolute or relative path
    root_folder:
      type: string
      required: True
    # recordings filename, relative to root folder
    recordings:
      type: string
      required: True
    # channel geometry filename, relative to root folder
    geometry:
      type: string
      required: True

resources:
  type: dict
  required: True
  schema:
    # maximum memory allowed in batch processing, can be a number (bytes)
    # or a string such as 1000MB, 2GB
    max_memory:
      type: [integer, string]
      required: True
    max_memory_gpu:
      type: [integer, string]
      required: False
      default: 1GB
    processes:
      type: [integer, string]
      required: False
      default: max


recordings:
  type: dict
  required: True
  schema:
    # precision of the recording â€“ must be a valid numpy dtype
    dtype:
      type: string
      required: True
    # recording rate (in Hz)
    sampling_rate:
      type: integer
      required: True
    # number of channels
    n_channels:
      type: integer
      required: True
    # channels spatial radius
    spatial_radius:
      type: integer
      required: True
    # temporal length of wavforms in ms
    spike_size_ms:
      type: float
      required: True
    # Recordings order, one of ('channels', 'samples'). In a dataset with k
    # observations per channel and j channels: 'channels' means first k contiguous
    # observations come from channel 0, then channel 1, and so on. 'sample'
    # means first j contiguous data are the first observations from
    # all channels, then the second observations from all channels and so on
    order:
      type: string
      required: True
      allowed: [channels, samples]

templates:
  type: dict
  default:
    save_results: True
    if_file_exists: skip
    max_shift: 3
    merge_threshold: [0.85, 0.8]
  schema:
    save_results:
      type: boolean
      default: True
      required: False
    if_file_exists:
      type: string
      allowed: [abort, overwrite, skip]
      required: False
      default: skip
    max_shift:
      type: integer
      required: False
      default: 3
    merge_threshold:
      type: list
      required: False
      default: [0.85, 0.8]